---
dg-publish: true
---
# Content Security Policy - CSP

- Pluralsight course: [Defeating Cross-site Scripting with Content Security Policy 2](library/courses/defeating-cross-site-scripting-content-security-policy/table-of-contents)

`Content-Security-Policy` is a HTTP header used to tell the client some "rules" it should follow to get content. For example, the frontend can tell the browser to not download content from another origin.

The official document is <https://www.w3.org/TR/CSP2/> ([CSP3](https://www.w3.org/TR/CSP/) is a working draft in March/2023)

## Directives

### CSP1

- default-src
    - report-uri: send information about policy violations
    - script-src: javascript source
    - object-src: not relevant today
    - style-src: CSS
    - img-src: images
    - media-src: audio and video
    - frame-src: frames (not very used today)
    - font-src: fonts
    - connect-src: which hosts javascript can connect to

### directive values

- protocol: e.g.: `http`
- url: e.g.: `http://www.example.com:80`
- constants:
    - `'self'`: the same origin as the frontend
    - `'unsafe-inline'`: allows inline CSS and JavaScript
    - `'unsafe-eval'`: allows eval or the function constructor(?)
    


## CSP generated by "CSP Generator"
```
default-src 'self';
script-src 'report-sample' 'self';
style-src 'report-sample' 'self';
object-src 'none';
base-uri 'self';
connect-src 'self' https://api-us.synthos.health;
font-src 'self';
frame-src 'self';
img-src 'self';
manifest-src 'self';
media-src 'self';
worker-src 'none';
```